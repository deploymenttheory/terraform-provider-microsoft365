---
page_title: "microsoft365_graph_beta_device_management_windows_device_compliance_script Resource - terraform-provider-microsoft365"
subcategory: "Device Management"

description: |-
  Manages Windows device compliance scripts using the /deviceManagement/deviceComplianceScripts endpoint. Device compliance scripts enable running PowerShell detection scripts on enrolled Windows 10/11 Azure Active Directory joined devices to validate compliance requirements and provide custom compliance assessments.
---

# microsoft365_graph_beta_device_management_windows_device_compliance_script (Resource)

Manages Windows device compliance scripts using the `/deviceManagement/deviceComplianceScripts` endpoint. Device compliance scripts enable running PowerShell detection scripts on enrolled Windows 10/11 Azure Active Directory joined devices to validate compliance requirements and provide custom compliance assessments.

## Microsoft Documentation

- [deviceComplianceScript resource type](https://learn.microsoft.com/en-us/graph/api/resources/intune-devices-devicehealthscript?view=graph-rest-beta)
- [Create deviceComplianceScript](https://learn.microsoft.com/en-us/graph/api/intune-devices-devicehealthscript-create?view=graph-rest-beta)
- [Update deviceComplianceScript](https://learn.microsoft.com/en-us/graph/api/intune-devices-devicehealthscript-update?view=graph-rest-beta)
- [Delete deviceComplianceScript](https://learn.microsoft.com/en-us/graph/api/intune-devices-devicehealthscript-delete?view=graph-rest-beta)

## API Permissions

The following API permissions are required in order to use this resource.

### Microsoft Graph

- **Application**: `DeviceManagementConfiguration.ReadWrite.All` , `DeviceManagementConfiguration.Read.All`

## Example Usage

```terraform
resource "microsoft365_graph_beta_device_management_windows_device_compliance_script" "example" {
  display_name            = "Windows Security Compliance Check"
  description             = "Checks for critical security configurations on Windows devices"
  publisher               = "IT Security Team"
  run_as_32_bit           = false
  enforce_signature_check = true
  run_as_account          = "user" // Optional values: "system", "user"

  detection_script_content = <<-EOT
    # Detection script for Windows security compliance
    # Check if Windows Defender is enabled
    $defenderStatus = Get-MpComputerStatus
    if ($defenderStatus.AntivirusEnabled -eq $false) {
      Write-Host "Windows Defender is disabled - Non-compliant"
      Exit 1
    }
    
    # Check if Windows Updates are configured properly
    $auSettings = Get-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" -ErrorAction SilentlyContinue
    if ($auSettings.NoAutoUpdate -eq 1) {
      Write-Host "Automatic updates are disabled - Non-compliant"
      Exit 1
    }
    
    # Check if firewall is enabled
    $firewallProfiles = Get-NetFirewallProfile
    $disabledProfiles = $firewallProfiles | Where-Object { $_.Enabled -eq $false }
    if ($disabledProfiles.Count -gt 0) {
      Write-Host "One or more firewall profiles are disabled - Non-compliant"
      Exit 1
    }
    
    Write-Host "All security checks passed - Compliant"
    Exit 0
  EOT

  timeouts = {
    create = "30m"
    read   = "5m"
    update = "30m"
    delete = "30m"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `detection_script_content` (String) The entire content of the detection PowerShell script.
- `display_name` (String) Name of the device compliance script.
- `publisher` (String) Name of the device compliance script publisher.
- `run_as_account` (String) Indicates the type of execution context. Possible values are: system, user.

### Optional

- `description` (String) Description of the device compliance script.
- `enforce_signature_check` (Boolean) Indicate whether the script signature needs be checked. Default is false, which does not check the script signature.
- `role_scope_tag_ids` (Set of String) Set of scope tag IDs for this device compliance script.
- `run_as_32_bit` (Boolean) Indicate whether PowerShell script should run as 32-bit. Default is false, which runs script in 64-bit PowerShell.
- `timeouts` (Attributes) (see [below for nested schema](#nestedatt--timeouts))

### Read-Only

- `created_date_time` (String) The timestamp of when the device compliance script was created. This property is read-only.
- `id` (String) Unique identifier for the device compliance script.
- `last_modified_date_time` (String) The timestamp of when the device compliance script was modified. This property is read-only.
- `version` (String) Version of the device compliance script.

<a id="nestedatt--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).
- `delete` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Setting a timeout for a Delete operation is only applicable if changes are saved into state before the destroy operation occurs.
- `read` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Read operations occur during any refresh or planning operation when refresh is enabled.
- `update` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).

## Version History

| Version | Status | Notes |
|---------|--------|-------|
| v0.23.0-alpha | Experimental | Initial release |

## Import

Import is supported using the following syntax:

```shell
#!/bin/bash

# Import an existing Windows Device Compliance Script
# Replace the GUID with the actual ID of your device compliance script

terraform import microsoft365_graph_beta_device_management_windows_device_compliance_script.example "00000000-0000-0000-0000-000000000000"
```