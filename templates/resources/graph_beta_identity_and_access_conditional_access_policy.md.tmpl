---
page_title: "{{.Name}} {{.Type}} - {{.ProviderName}}"
subcategory: "Identity and Access"
description: |-
{{ .Description | plainmarkdown | trimspace | prefixlines "  " }}
---

# {{.Name}} ({{.Type}})

{{ .Description | trimspace }}

## Microsoft Documentation

- [Conditional Access documentation](https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/)
- [conditionalAccessPolicy resource type](https://learn.microsoft.com/en-us/graph/api/resources/conditionalaccesspolicy?view=graph-rest-beta)
- [Create conditionalAccessPolicy](https://learn.microsoft.com/en-us/graph/api/conditionalaccessroot-post-policies?view=graph-rest-beta)
- [Update conditionalAccessPolicy](https://learn.microsoft.com/en-us/graph/api/conditionalaccesspolicy-update?view=graph-rest-beta)
- [Delete conditionalAccessPolicy](https://learn.microsoft.com/en-us/graph/api/conditionalaccesspolicy-delete?view=graph-rest-beta)


## Microsoft Graph API Permissions

The following client `application` permissions are needed in order to use this {{.Type | lower}}:

**Required:**
- `Policy.ReadWrite.ConditionalAccess`
- `Policy.Read.All`

**Optional:**
- `None` `[N/A]`

## Version History

| Version | Status | Notes |
|---------|--------|-------|
| v0.19.0-alpha | Experimental | Initial release |
| v0.34.0-alpha | Experimental | Numerous bug fixes and added graceful 429 error handling |

## Example Usage

### Device-Based Policies (CAD)

#### CAD001: macOS Compliant Device Access

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad001-o365.tf" }}

#### CAD002: Windows Compliant Device Access

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad002-o365.tf" }}

#### CAD003: iOS/iPadOS Compliant Device Access

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad003-o365.tf" }}

#### CAD004: Android Compliant Device Access

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad004-o365.tf" }}

#### CAD005: Non-Compliant Device Block

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad005-o365.tf" }}

#### CAD006: macOS App Protection Policy

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad006-o365.tf" }}

#### CAD007: Windows App Protection Policy

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad007-o365.tf" }}

#### CAD008: iOS/iPadOS App Protection Policy

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad008-all.tf" }}

#### CAD009: Android App Protection Policy

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad009-all.tf" }}

#### CAD010: Remote Desktop Services Compliance

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad010-rjd.tf" }}

#### CAD011: Require MFA for Non-Compliant Devices

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad011-o365.tf" }}

#### CAD012: Block Unmanaged Devices

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad012-all.tf" }}

#### CAD013: Compliant macOS for Admin Roles

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad013-selected.tf" }}

#### CAD014: Compliant Windows for Admin Roles

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad014-o365.tf" }}

#### CAD015: Compliant iOS/iPadOS for Admin Roles

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad015-all.tf" }}

#### CAD016: Compliant Device for Exchange/SharePoint/Cloud PC

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad016-exo_spo_cloudpc.tf" }}

#### CAD017: Compliant Android for Admin Roles

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad017-selected.tf" }}

#### CAD018: Compliant Device for Cloud PC

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad018-cloudpc.tf" }}

#### CAD019: Compliant Device for Intune Enrollment

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cad019-intune.tf" }}

### Platform-Based Policies (CAP)

#### CAP001: Block Legacy Authentication

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cap001-all.tf" }}

#### CAP002: Block Exchange ActiveSync

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cap002-all.tf" }}

#### CAP003: Block Device Code Flow

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cap003-all.tf" }}

#### CAP004: Block Authentication Transfer

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cap004-all.tf" }}

### Location-Based Policies (CAL)

#### CAL001: Block Specified Locations

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cal001-all.tf" }}

#### CAL002: MFA Registration from Trusted Locations Only

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cal002-rsi.tf" }}

#### CAL003: Block Service Accounts from Non-Trusted Locations

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cal003-all.tf" }}

#### CAL004: Block Admin Access from Non-Trusted Locations

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cal004-all.tf" }}

#### CAL005: Less-Trusted Locations Require Compliance

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cal005-selected.tf" }}

#### CAL006: Allow Access Only from Specified Locations

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cal006-all.tf" }}

### User-Based Policies (CAU)

#### CAU001: Require MFA for Guest Users

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau001-all.tf" }}

#### CAU001A: Require MFA for Guests - Windows Azure AD

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau001a-windows_azure_active_directory.tf" }}

#### CAU002: Require MFA for All Users

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau002-all.tf" }}

#### CAU003: Block Unapproved Apps for Guests

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau003-selected.tf" }}

#### CAU004: Route Through Microsoft Defender for Cloud Apps

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau004-selected.tf" }}

#### CAU006: MFA for Medium/High Sign-in Risk

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau006-all.tf" }}

#### CAU007: Password Change for Medium/High User Risk

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau007-all.tf" }}

#### CAU008: Phishing-Resistant MFA for Admins

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau008-all.tf" }}

#### CAU009: Require MFA for Admin Portals

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau009-management.tf" }}

#### CAU010: Require Terms of Use

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau010-all.tf" }}

#### CAU011: Block Unlicensed Users

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau011-all.tf" }}

#### CAU012: Security Info Registration with TAP

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau012-rsi.tf" }}

#### CAU013: Phishing-Resistant MFA for All Users

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau013-all.tf" }}

#### CAU014: Block Managed Identity for Medium/High Sign-in Risk

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau014-all.tf" }}

#### CAU015: Block High Sign-in Risk

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau015-all.tf" }}

#### CAU016: Block High User Risk

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau016-all.tf" }}

#### CAU017: Admin Sign-in Frequency

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau017-all.tf" }}

#### CAU018: Disable Browser Persistence for Admins

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau018-all.tf" }}

#### CAU019: Allow Only Approved Apps for Guests

{{ tffile "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/resource_cau019-selected.tf" }}

{{ .SchemaMarkdown | trimspace }}

## Important Notes

### Policy States
- **enabled**: The policy is active and will be enforced
- **disabled**: The policy exists but is not enforced
- **enabledForReportingButNotEnforced**: The policy will be evaluated and logged but not enforced (report-only mode)

### Applications
- Use `"All"` to target all cloud applications
- Use `"Office365"` to target all Office 365 applications
- Use specific application IDs for targeted policies
- Application filters support complex OData expressions for fine-grained control

### Users and Groups
- Use `"All"` to target all users
- Use `"GuestsOrExternalUsers"` to target external users
- Specify user, group, or role object IDs for targeted policies
- Emergency access accounts should always be excluded from blocking policies

### Locations
- Named locations must be created in Azure AD before referencing
- Use `"All"` for all locations or `"AllTrusted"` for all trusted locations
- IP-based and country-based locations are supported

### Client App Types
- `browser`: Web browsers
- `mobileAppsAndDesktopClients`: Mobile apps and desktop clients
- `exchangeActiveSync`: Exchange ActiveSync clients
- `other`: Other clients including legacy authentication

### Grant Controls
- **Operator**: `AND` requires all controls, `OR` requires any control
- **Built-in Controls**: `block`, `mfa`, `compliantDevice`, `domainJoinedDevice`, `approvedApplication`, `compliantApplication`, `passwordChange`
- **Authentication Strength**: Reference to custom authentication strength policies

### Session Controls
- **Application Restrictions**: Control access to specific applications
- **Cloud App Security**: Integration with Microsoft Defender for Cloud Apps
- **Sign-in Frequency**: Control how often users must re-authenticate
- **Persistent Browser**: Control browser session persistence
- **Continuous Access Evaluation**: Real-time policy evaluation

### Device Filters
- Support complex OData expressions for device-based conditions
- Common filters include device compliance, trust type, and device attributes
- Use `include` mode to target devices matching the filter
- Use `exclude` mode to exclude devices matching the filter

### Risk-based Policies
- **User Risk Levels**: `low`, `medium`, `high`, `hidden`, `none`, `unknownFutureValue`
- **Sign-in Risk Levels**: `low`, `medium`, `high`, `hidden`, `none`, `unknownFutureValue`
- Requires Azure AD Identity Protection licenses

### Best Practices
- Always exclude emergency access accounts from blocking policies
- Test policies in report-only mode before enabling enforcement
- Use specific targeting rather than broad "All" assignments when possible
- Monitor policy impact through Azure AD sign-in logs
- Implement a phased rollout for new policies
- Document policy purpose and expected behavior

### Common Policy Scenarios
- **Block Legacy Authentication**: Target legacy client app types with block control
- **Require MFA for Admins**: Target administrative roles with MFA requirement
- **Device Compliance**: Require compliant or domain-joined devices for access
- **Location-based Access**: Block or require additional controls based on location
- **Risk-based Access**: Respond to user or sign-in risk with appropriate controls

## Import

Import is supported using the following syntax:

{{ codefile "shell" "examples/resources/microsoft365_graph_beta_identity_and_access_conditional_access_policy/import.sh" }} 