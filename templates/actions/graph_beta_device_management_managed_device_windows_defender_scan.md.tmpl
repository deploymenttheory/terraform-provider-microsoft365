---
page_title: "{{.Name}} {{.Type}} - {{.ProviderName}}"
subcategory: "Device Management"

description: |-
{{ if .Description }}{{ .Description | plainmarkdown | trimspace | prefixlines "  " }}{{ else }}  Triggers Windows Defender antivirus scans on Windows devices.{{ end }}
---

# {{.Name}} ({{.Type}})

{{ if .Description }}{{ .Description | trimspace }}{{ else }}Triggers immediate Windows Defender (Microsoft Defender Antivirus) scans on managed and co-managed Windows devices, with configurable scan types (quick or full) for each device.{{ end }}

## Microsoft Documentation

### Graph API References
- [windowsDefenderScan action](https://learn.microsoft.com/en-us/graph/api/intune-devices-manageddevice-windowsdefenderscan?view=graph-rest-beta)
- [managedDevice resource type](https://learn.microsoft.com/en-us/graph/api/resources/intune-devices-manageddevice?view=graph-rest-beta)

### Intune Remote Actions Guides
- [Windows Remote Actions](https://learn.microsoft.com/en-us/intune/intune-service/remote-actions/?tabs=windows)
- [iOS/iPadOS Remote Actions](https://learn.microsoft.com/en-us/intune/intune-service/remote-actions/?tabs=ios-ipados)
- [macOS Remote Actions](https://learn.microsoft.com/en-us/intune/intune-service/remote-actions/?tabs=macos)
- [Android Remote Actions](https://learn.microsoft.com/en-us/intune/intune-service/remote-actions/?tabs=android)
- [ChromeOS Remote Actions](https://learn.microsoft.com/en-us/intune/intune-service/remote-actions/?tabs=chromeos)

## API Permissions

The following API permissions are required in order to use this action.

### Microsoft Graph

- **Application**: `DeviceManagementManagedDevices.PrivilegedOperations.All`
- **Delegated**: `DeviceManagementManagedDevices.PrivilegedOperations.All`

## Version History

| Version | Status | Notes |
|---------|--------|-------|
| v0.33.0-alpha | Experimental | Initial release |

## Notes

### Platform Compatibility

| Platform | Managed Devices | Co-Managed Devices | Notes |
|----------|----------------|-------------------|-------|
| **Windows 10/11** | ✅ Full Support | ✅ Full Support | Primary platform |
| **Windows Server** | ✅ Full Support | ✅ Full Support | If Defender enabled |
| **macOS** | ❌ Not Supported | ❌ Not Applicable | Uses different antivirus |
| **iOS/iPadOS** | ❌ Not Supported | ❌ Not Applicable | No Defender available |
| **Android** | ❌ Not Supported | ❌ Not Applicable | Uses Defender for Endpoint (different action) |
| **ChromeOS** | ❌ Not Supported | ❌ Not Applicable | No Defender support |

### Scan Types Comparison

| Feature | Quick Scan | Full Scan |
|---------|-----------|-----------|
| **Duration** | 5-15 minutes | 30+ minutes to several hours |
| **Coverage** | Common threat locations | Entire system |
| **Performance Impact** | Minimal | Moderate to significant |
| **Recommended For** | Routine checks, daily scans | Security incidents, deep investigation |
| **Scans** | System folders, registry, memory, startup | All files, all drives, archives |
| **User Impact** | Minimal disruption | May slow down device |
| **Best Used** | During work hours | During off-hours |

### Quick Scan Details

**What Gets Scanned:**
- System folders (Windows, Program Files, ProgramData)
- Registry keys (startup, run keys)
- Active memory processes
- Boot sectors
- Startup locations
- Common malware locations

**Characteristics:**
- Fast completion (5-15 minutes)
- Minimal CPU/disk usage
- Users can work normally
- Detects most common threats
- Updates definitions before scanning
- Recommended for routine use

**Best For:**
- Daily/weekly scheduled scans
- Routine security checks
- Post-patch verification
- General maintenance
- During business hours
- BYOD devices

### Full Scan Details

**What Gets Scanned:**
- All files on all drives
- All folders and subfolders
- Archive files (ZIP, RAR, etc.)
- Boot sectors and firmware
- All registry keys
- Network drives (if mapped)
- Removable media
- Memory and processes

**Characteristics:**
- Thorough and comprehensive
- Long duration (30 min to hours)
- Higher CPU and disk usage
- May impact performance
- Detects hidden/deep threats
- More resource-intensive

**Best For:**
- Security incidents
- Malware suspected
- Post-infection cleanup
- Compliance requirements
- Off-hours scanning
- Monthly deep scans

### Scan Process

**Initialization**
1. Device receives scan command (if online)
2. Windows Defender service starts
3. Threat definitions updated
4. Scan begins immediately

**During Scan**
- Real-time protection continues
- Background process
- Can be paused by user
- Progress visible to user
- Threats quarantined automatically

**After Scan**
- Results reported to Intune
- Threats logged and quarantined
- Scan summary available
- User notification displayed
- Admin center updated

**Threat Handling**
- Threats automatically quarantined
- Malware removed or blocked
- Suspicious files isolated
- User and admin notified
- Remediation logged

### Performance Impact

| System Type | Quick Scan Impact | Full Scan Impact |
|-------------|------------------|------------------|
| **Modern Workstation** | Minimal (< 5% CPU) | Moderate (10-30% CPU) |
| **Laptop** | Minimal | Battery drain increase |
| **Server** | Minimal | May affect services |
| **Older Hardware** | Slight slowdown | Significant slowdown |
| **SSD Storage** | Negligible | Low |
| **HDD Storage** | Low | Moderate to High |

### Use Cases

| Scenario | Recommended Scan | Frequency | Timing |
|----------|-----------------|-----------|--------|
| **Routine Maintenance** | Quick | Daily/Weekly | Business hours |
| **Security Incident** | Full | Immediate | ASAP |
| **Malware Suspected** | Full | Immediate | ASAP |
| **Post-Patch** | Quick | After updates | Anytime |
| **Compliance Audit** | Full | Monthly/Quarterly | Off-hours |
| **New Device Enrollment** | Quick | Once | After enrollment |
| **User Report Issue** | Full | As needed | Off-hours preferred |
| **Threat Intel Alert** | Full | Emergency | Immediate |

### Best Practices

**Scan Scheduling**
- **Quick Scans**: During business hours (minimal impact)
- **Full Scans**: Off-hours, weekends, overnight
- Avoid scanning during critical business operations
- Consider time zones for global deployments
- Stagger scans to avoid network congestion

**Device Considerations**
- Check device uptime and availability
- Ensure devices are online
- Consider battery status for laptops
- Verify adequate disk space
- Check network bandwidth

**Resource Management**
- Batch devices into manageable groups
- Don't scan entire fleet simultaneously
- Monitor scan progress
- Plan for failed scans (offline devices)
- Set appropriate timeouts

**User Communication**
- Notify users before full scans
- Explain performance impact
- Provide estimated duration
- Advise saving work
- Set expectations

**Threat Response**
- Full scan immediately on threat detection
- Isolate affected devices
- Review scan results
- Follow up with remediation
- Document incidents

### Scan Results and Reporting

**Intune Admin Center**
1. Navigate to Devices → All devices
2. Select device
3. View "Defender Antivirus" section
4. Check "Last scan" timestamp
5. Review "Threats found"
6. Check "Scan status"

**Information Available**
- Last scan date/time
- Scan type (quick/full)
- Scan status (completed/failed/in progress)
- Threats found
- Threats quarantined
- Scan duration
- Definition version

**Time to Complete**
- Command delivery: < 1 minute
- Quick scan: 5-15 minutes
- Full scan: 30+ minutes to hours
- Results reporting: Real-time
- Console update: 5-15 minutes

### Threat Detection and Remediation

**Automatic Actions**
- Malware quarantined immediately
- Threats blocked from executing
- Suspicious files isolated
- Registry changes reverted
- System protected

**Threat Types Detected**
- Viruses and worms
- Trojans and spyware
- Ransomware
- Potentially unwanted applications (PUA)
- Rootkits
- Bootkits
- Exploits
- Backdoors

**Remediation Options**
- Automatic (recommended)
- User confirmation
- Custom actions
- Allow/block lists
- Exclusions

### Troubleshooting

| Issue | Cause | Solution |
|-------|-------|----------|
| Scan doesn't start | Device offline | Wait for device to come online |
| Scan fails | Defender disabled | Enable Defender in policy |
| Timeout | Full scan too long | Increase timeout setting |
| No results | Scan in progress | Wait for completion |
| Permission denied | Insufficient rights | Check API permissions |
| Device not found | Invalid device ID | Verify device exists |
| Non-Windows device | Wrong OS | Filter for Windows only |
| Scan cancelled | User intervention | Re-run scan, notify user |

### Limitations

**Technical Limits**
- Windows devices only
- Requires Windows Defender
- Device must be online
- Network connectivity required
- Definitions must be up-to-date

**Operational Limits**
- User can pause/cancel scan
- Performance impact during full scan
- Scan duration varies by device
- Offline devices won't scan
- Battery-powered devices may defer

**Platform Limits**
- Not available on non-Windows platforms
- Requires Windows Defender enabled
- Some devices may have third-party AV
- Co-managed devices require both systems healthy

### Windows Defender Requirements

**Minimum Requirements**
- Windows 10/11 or Windows Server
- Windows Defender Antivirus installed
- Windows Defender service running
- Real-time protection can be enabled or disabled
- Definitions can be outdated (updated before scan)

**Policy Requirements**
- Defender not disabled by group policy
- Scan permissions allowed
- Remote actions enabled
- Device enrolled in Intune

**Network Requirements**
- Internet connectivity
- Access to definition updates
- Access to Intune endpoints
- Firewall permits traffic

### Definition Updates

**Before Scan**
- Definitions automatically updated
- Latest signatures downloaded
- Ensures current threat detection
- May add 1-2 minutes to scan time

**Update Sources**
- Microsoft Update
- Windows Update
- WSUS
- Internal distribution
- Direct download

### Co-Management Context

**How Scanning Works**
- This action triggers scan via Intune endpoint
- ConfigMgr can also trigger scans independently
- Both systems can view results
- No conflict between systems
- Workload assignment doesn't affect scan capability

**Best Practices**
- Coordinate with ConfigMgr team
- Avoid duplicate scan scheduling
- Use one system for scan management
- Share scan results between teams
- Document which system manages scans

## Example Usage

{{ tffile "examples/actions/graph_beta_device_management_managed_device_windows_defender_scan/action.tf" }}

{{ if .SchemaMarkdown }}{{ .SchemaMarkdown | trimspace }}{{ else }}Schema documentation not available.{{ end }}


