---
page_title: "{{.Name}} {{.Type}} - {{.ProviderName}}"
subcategory: "Device Management"

description: |-
{{ if .Description }}{{ .Description | plainmarkdown | trimspace | prefixlines "  " }}{{ else }}  Initiates on-demand proactive remediation (health scripts) on managed Windows devices.{{ end }}
---

# {{.Name}} ({{.Type}})

{{ if .Description }}{{ .Description | trimspace }}{{ else }}Initiates on-demand execution of proactive remediation scripts on managed Windows devices, enabling immediate issue detection and automated fixes outside of scheduled runs.{{ end }}

## Microsoft Documentation

### Graph API References
- [initiateOnDemandProactiveRemediation action](https://learn.microsoft.com/en-us/graph/api/intune-devices-manageddevice-initiateondemandproactiveremediation?view=graph-rest-beta)
- [managedDevice resource type](https://learn.microsoft.com/en-us/graph/api/resources/intune-devices-manageddevice?view=graph-rest-beta)

### Proactive Remediations Guides
- [Proactive remediations in Intune](https://learn.microsoft.com/en-us/mem/intune/fundamentals/remediations)
- [Create and run remediations scripts](https://learn.microsoft.com/en-us/mem/analytics/proactive-remediations)
- [Monitor remediations script results](https://learn.microsoft.com/en-us/mem/intune/fundamentals/remediations#monitor-your-scripts)

## API Permissions

The following API permissions are required in order to use this action.

### Microsoft Graph

- **Application**: `DeviceManagementConfiguration.Read.All`, `DeviceManagementManagedDevices.Read.All`
- **Delegated**: `DeviceManagementConfiguration.Read.All`, `DeviceManagementManagedDevices.Read.All`

## Version History

| Version | Status | Notes |
|---------|--------|-------|
| v0.33.0-alpha | Experimental | Initial release |
| v0.40.0-alpha | Experimental | Example fixes and refactored sync progress logic |


## Notes

### Platform Compatibility

| Platform | Support | Requirements |
|----------|---------|--------------|
| **Windows** | ✅ Full Support | Windows 10/11 with Intune Management Extension installed |
| **macOS** | ❌ Not Supported | Proactive remediations are Windows-specific |
| **iOS/iPadOS** | ❌ Not Supported | Proactive remediations are Windows-specific |
| **Android** | ❌ Not Supported | Proactive remediations are Windows-specific |

### What are Proactive Remediations?

**Proactive remediations** (also called **remediations** or **health scripts**) are:
- PowerShell scripts that run on Windows devices
- Designed to detect and automatically fix common support issues
- Consist of two scripts: detection script and remediation script
- Execute with SYSTEM-level privileges
- Scheduled to run at regular intervals (hourly, daily, weekly)
- Provide detailed execution results and status reporting

### Script Components

| Component | Purpose | Execution |
|-----------|---------|-----------|
| **Detection Script** | Identifies if issue exists | Always runs first |
| **Remediation Script** | Fixes the detected issue | Only runs if detection finds issue |

**Exit Codes:**
- **Detection**: 0 = No issue, 1 = Issue detected
- **Remediation**: 0 = Success, 1 = Failure

### On-Demand vs Scheduled Execution

| Aspect | Scheduled Execution | On-Demand Execution (This Action) |
|--------|-------------------|-----------------------------------|
| **Timing** | Per policy schedule (hourly/daily/weekly) | Immediate on next device check-in |
| **Initiation** | Automatic | Manual via API call |
| **Use Case** | Regular proactive maintenance | Urgent fixes, troubleshooting |
| **Deployment** | Policy must be assigned | Policy must already be deployed |

### How On-Demand Remediation Works

1. **Action Triggered**: API call initiates on-demand execution
2. **Device Check-in**: Device connects to Intune (typically within minutes)
3. **Script Download**: Intune Management Extension downloads scripts
4. **Detection Runs**: Detection script executes with SYSTEM privileges
5. **Conditional Remediation**: If issue detected, remediation script runs
6. **Result Upload**: Exit codes and output uploaded to Intune
7. **Portal Update**: Results visible in Intune portal

### Finding Script Policy IDs

**Method 1: Azure Portal**
1. Navigate to **Intune** → **Devices** → **Remediations**
2. Select the remediation script
3. Copy GUID from URL: `...remediations/{GUID}/...`

**Method 2: Graph Explorer**
```http
GET https://graph.microsoft.com/beta/deviceManagement/deviceHealthScripts
```

**Method 3: PowerShell**
```powershell
Connect-MgGraph
Get-MgDeviceManagementDeviceHealthScript | Select-Object Id, DisplayName
```

### When to Use On-Demand Remediation

- **Urgent Issues**: Critical problems requiring immediate attention
- **Troubleshooting**: Testing or validating remediation effectiveness
- **End-User Requests**: User-reported issues needing quick resolution
- **Post-Incident**: Recovery actions after security or stability incidents
- **Validation**: Verifying new scripts before scheduled deployment
- **Ad-Hoc Fixes**: One-time corrections outside regular schedule

### Script Execution Details

**Execution Context:**
- Runs as **SYSTEM** account (highest privileges)
- 32-bit PowerShell by default (configurable in script settings)
- Maximum execution time: 60 minutes (timeout)
- Network access available
- Registry and file system full access

**Execution Timing:**
- Initiated at next device check-in (typically 8 hours or less)
- Can be forced immediately via device sync action
- Scripts queue if multiple remediation triggered

### Important Considerations

✅ **Requirements:**
- Script policy must already be deployed to device
- Device must have Intune Management Extension installed
- Windows 10 version 1607 or later
- Device must be online and checking in
- Script must be in "Published" state

⚠️ **Limitations:**
- Cannot create new script deployments
- Only triggers execution of existing assignments
- Script must be previously deployed to device
- Cannot modify script content via this action
- Results may take minutes to appear in portal

### Troubleshooting

**Common Issues:**

1. **Script Not Found**
   - Error: Script policy ID not recognized
   - Solution: Verify script policy ID is correct
   - Check: Script is published and deployed

2. **Device Not Responding**
   - Issue: Script doesn't execute
   - Solution: Force device sync first
   - Check: Device last check-in time

3. **Script Fails to Execute**
   - Issue: Script errors during execution
   - Solution: Review script logs on device
   - Location: `C:\ProgramData\Microsoft\IntuneManagementExtension\Logs`

4. **No Results Visible**
   - Issue: Results not showing in portal
   - Solution: Wait 15-30 minutes for sync
   - Check: Device connectivity and IME service status

### Best Practices

**Operational:**
- ✅ Test scripts thoroughly before on-demand execution
- ✅ Document why on-demand execution is needed
- ✅ Monitor script execution results closely
- ✅ Use for urgent issues only (respect scheduled runs)
- ✅ Validate script assignment before triggering
- ✅ Force device sync if immediate execution needed

**Security:**
- ✅ Review script content before execution (SYSTEM privileges)
- ✅ Audit all on-demand executions
- ✅ Restrict access to script policy IDs
- ✅ Monitor for unexpected script modifications
- ✅ Validate script source and author
- ✅ Test in non-production first

**Efficiency:**
- ✅ Batch similar issues together
- ✅ Use dynamic configuration for multiple devices
- ✅ Track script execution success rates
- ✅ Document common remediation patterns
- ✅ Maintain script library documentation

### Viewing Results

**Intune Portal:**
1. Navigate to **Devices** → **Remediations**
2. Select the remediation script
3. View **Device status** tab
4. Check individual device results

**What's Reported:**
- Detection status (Issue detected or not)
- Remediation status (Ran, succeeded, failed)
- Script output (stdout/stderr)
- Exit codes
- Execution timestamp
- Pre-remediation/post-remediation snapshots (if configured)

## Example Usage

{{ tffile "examples/actions/graph_beta_device_management_managed_device_initiate_on_demand_proactive_remediation/action.tf" }}

{{ if .SchemaMarkdown }}{{ .SchemaMarkdown | trimspace }}{{ else }}Schema documentation not available.{{ end }}

