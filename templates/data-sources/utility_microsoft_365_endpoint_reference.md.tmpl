---
page_title: "{{.Name}} {{.Type}} - {{.ProviderName}}"
subcategory: "Utility"

description: |-
{{ .Description | plainmarkdown | trimspace | prefixlines "  " }}
---

# {{.Name}}

Retrieves Microsoft 365 network endpoints from the official [Microsoft 365 IP Address and URL Web Service](https://learn.microsoft.com/en-us/microsoft-365/enterprise/microsoft-365-ip-web-service).

This datasource queries `https://endpoints.office.com` to get current IP addresses, URLs, and ports for Microsoft 365 services. 
It's designed for automating firewall rules, proxy configurations, SD-WAN policies, and PAC files with always up-to-date Microsoft 365 network requirements.

## Background

Microsoft publishes network endpoints for Microsoft 365 services through a REST API that is updated regularly. These endpoints include:

- **FQDNs/URLs**: Destination domains and URL patterns (may include wildcards like `*.office.com`)
- **IP Ranges**: IPv4 and IPv6 address ranges in CIDR notation
- **Ports**: TCP and UDP port numbers required for each service
- **Categories**: Network optimization categories (`Optimize`, `Allow`, `Default`)
- **Service Areas**: Exchange Online, SharePoint Online, Microsoft Teams, and common services

Network administrators use this data to:
- Configure firewalls and security appliances
- Define proxy bypass lists (PAC files)
- Implement SD-WAN and QoS policies
- Plan Azure ExpressRoute for Microsoft 365
- Optimize network paths for latency-sensitive traffic

## Network Categories

Microsoft defines three network categories based on optimization requirements:

### Optimize (Highest Priority)
- **Description**: Latency-sensitive services with highest traffic volume
- **Examples**: Exchange Online mailbox access, Teams real-time media (audio/video)
- **Recommended Treatment**:
  - Direct internet routing (bypass proxy and packet inspection)
  - Lowest latency network path
  - QoS marking: DSCP EF (46) for real-time media
  - Never proxy or perform TLS inspection
- **Typical Impact**: 70% of Microsoft 365 bandwidth, most sensitive to network conditions

### Allow (Medium Priority)
- **Description**: Required endpoints for core functionality with lower latency sensitivity
- **Examples**: Exchange mail flow (SMTP), SharePoint/OneDrive file operations
- **Recommended Treatment**:
  - Direct routing preferred but proxy acceptable
  - Standard QoS policies
  - TLS inspection acceptable with caution
- **Typical Impact**: 20% of Microsoft 365 bandwidth

### Default (Standard Priority)
- **Description**: Optional services or low-priority traffic
- **Examples**: Office CDNs, telemetry, updates, optional features
- **Recommended Treatment**:
  - Can route through standard proxy
  - Normal firewall inspection
  - Standard QoS
- **Typical Impact**: 10% of Microsoft 365 bandwidth

See [Microsoft 365 Network Connectivity Principles](https://learn.microsoft.com/en-us/microsoft-365/enterprise/microsoft-365-network-connectivity-principles) for detailed guidance.

## Supported Cloud Instances

| Instance Value | Description | API Endpoint |
|----------------|-------------|--------------|
| `worldwide` | Worldwide commercial cloud (includes US GCC) | `https://endpoints.office.com/endpoints/worldwide` |
| `usgov-dod` | US Government DoD | `https://endpoints.office.com/endpoints/USGOVDoD` |
| `usgov-gcchigh` | US Government GCC High | `https://endpoints.office.com/endpoints/USGOVGCCHigh` |
| `china` | Microsoft 365 operated by 21Vianet (China) | `https://endpoints.office.com/endpoints/China` |

## Service Areas

- **MEM**: Microsoft Endpoint Manager (Intune, Autopilot, Windows Updates, Remote Help)
- **Exchange**: Exchange Online, Outlook, Exchange Online Protection (EOP)
- **SharePoint**: SharePoint Online and OneDrive for Business
- **Skype**: Microsoft Teams and Skype for Business Online
- **Common**: Microsoft Entra ID, Office 365 portal, shared services

## Version History

| Version | Status | Notes |
|---------|--------|-------|
| v0.36.0-alpha | Experimental | Initial release |

## Example Usage

### Basic Usage

{{ tffile "examples/data-sources/microsoft365_utility_microsoft_365_endpoint_reference/basic.tf" }}

### Comprehensive Filtering and Outputs

{{ tffile "examples/data-sources/microsoft365_utility_microsoft_365_endpoint_reference/data-source.tf" }}

### Advanced Firewall Automation

{{ tffile "examples/data-sources/microsoft365_utility_microsoft_365_endpoint_reference/firewall-automation.tf" }}

### Microsoft Endpoint Manager (Intune) Endpoints

{{ tffile "examples/data-sources/microsoft365_utility_microsoft_365_endpoint_reference/mem-endpoints.tf" }}

## Argument Reference

* `instance` - (Required) The Microsoft 365 cloud instance to query. Valid values: `worldwide`, `usgov-dod`, `usgov-gcchigh`, `china`.

* `service_areas` - (Optional) Filter endpoints by service area. Valid values: `MEM`, `Exchange`, `SharePoint`, `Skype`, `Common`. If omitted, returns all service areas.

* `categories` - (Optional) Filter endpoints by network optimization category. Valid values: `Optimize`, `Allow`, `Default`. If omitted, returns all categories.

* `required_only` - (Optional) If `true`, only returns endpoints marked as required by Microsoft. Optional endpoints provide enhanced functionality but are not necessary for core service operation. Defaults to `false`.

* `express_route` - (Optional) If `true`, only returns endpoints that support Azure ExpressRoute for Microsoft 365. Useful for organizations using ExpressRoute for optimized connectivity. Defaults to `false`.

* `timeouts` - (Optional) Timeout configuration block. See [Timeouts](#timeouts) below.

## Additional Resources

- [Microsoft 365 Network Connectivity Principles](https://learn.microsoft.com/en-us/microsoft-365/enterprise/microsoft-365-network-connectivity-principles)
- [Managing Microsoft 365 Endpoints](https://learn.microsoft.com/en-us/microsoft-365/enterprise/managing-office-365-endpoints)
- [Microsoft 365 IP Address and URL Web Service](https://learn.microsoft.com/en-us/microsoft-365/enterprise/microsoft-365-ip-web-service)
- [Microsoft 365 Endpoints Documentation](https://learn.microsoft.com/en-us/microsoft-365/enterprise/microsoft-365-endpoints)
- [Unified cloud.microsoft Domain](https://learn.microsoft.com/en-us/microsoft-365/enterprise/cloud-microsoft-domain)
- [Office 365 URLs and IP address ranges](https://learn.microsoft.com/en-us/microsoft-365/enterprise/urls-and-ip-address-ranges)

